{'variable': 'spark', 'data_source': [{'func_call': {'from': {'from': 'SparkSession', 'method': 'builder'}, 'method': 'appName'}, 'data_file': ['test'], 'params': []}, {'func_call': {'from': None, 'method': 'master'}, 'data_file': ['local'], 'params': []}, {'func_call': {'from': None, 'method': 'getOrCreate'}, 'data_file': [], 'params': []}, None]}
{'variable': 'test', 'data_source': [{'func_call': {'from': {'from': 'spark', 'method': 'read'}, 'method': 'option'}, 'data_file': ['header', 'true'], 'params': []}, {'func_call': {'from': None, 'method': 'csv'}, 'data_file': ['./test_data/retail-data/all/online-retail-dataset.csv'], 'params': []}, {'func_call': {'from': None, 'method': 'repartition'}, 'data_file': [2], 'params': []}, {'func_call': {'from': None, 'method': 'selectExpr'}, 'data_file': ["instr(Description, 'GLASS') >= 1 as is_glass"], 'params': []}, {'func_call': {'from': None, 'method': 'limit'}, 'data_file': [10], 'params': []}, None]}
{'variable': 'a', 'data_source': [{'func_call': {'from': 'spark', 'method': 'createDataFrame'}, 'data_file': [None, None], 'params': []}, None]}
{'variable': 'rating', 'data_source': [None]}
{'variable': 'a', 'data_source': [{'func_call': {'from': 'spark', 'method': 'createDataFrame'}, 'data_file': [None, None], 'params': []}, None]}
{'variable': 'b', 'data_source': [{'func_call': {'from': 'spark', 'method': 'createDataFrame'}, 'data_file': [None, None], 'params': []}, None, {'func_call': {'from': 'a', 'method': 'show'}, 'data_file': [], 'params': []}, {'func_call': {'from': 'b', 'method': 'show'}, 'data_file': [], 'params': []}]}
{'variable': 'w', 'data_source': [{'func_call': {'from': 'Window', 'method': 'orderBy'}, 'data_file': [{'func_call': 'monotonically_increasing_id', 'data_file': [], 'params': []}], 'params': []}, None]}
{'variable': 'a', 'data_source': [{'func_call': {'from': {'func_call': 'row_number', 'data_file': [], 'params': []}, 'method': 'over'}, 'data_file': ['w'], 'params': []}, {'func_call': {'from': 'a', 'method': 'withColumn'}, 'data_file': ['row_idx', None], 'params': []}, None]}
{'variable': 'b', 'data_source': [{'func_call': {'from': {'func_call': 'row_number', 'data_file': [], 'params': []}, 'method': 'over'}, 'data_file': ['w'], 'params': []}, {'func_call': {'from': 'b', 'method': 'withColumn'}, 'data_file': ['row_idx', None], 'params': []}, None]}
{'variable': 'final_df', 'data_source': [{'func_call': {'from': 'a', 'method': 'join'}, 'data_file': ['b', {'left_op': {'from': 'a', 'method': 'row_idx'}, 'operator': [<ast.Eq object at 0x7fc40e19da90>], 'right': {'from': 'b', 'method': 'row_idx'}}], 'params': []}, {'func_call': {'from': None, 'method': 'drop'}, 'data_file': ['row_idx'], 'params': []}, None, {'func_call': {'from': 'final_df', 'method': 'show'}, 'data_file': [], 'params': []}]}
